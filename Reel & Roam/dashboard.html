<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Memory Gallery with Appwrite Integration and Theme Toggle</title>
    <link rel="stylesheet" href="dashboard1.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>

<body class="dashboard-body">
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-plane"></i>
            <span>Reel & Roam</span>
        </div>
        <nav class="sidebar-nav">
            <a href="#dashboard" class="nav-item active" onclick="showSection('dashboard')">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </a>
            <a href="#plan-trip" class="nav-item" onclick="showSection('plan-trip')">
                <i class="fas fa-map"></i>
                <span>Plan Trip</span>
            </a>
            <a href="#budget" class="nav-item" onclick="showSection('budget')">
                <i class="fas fa-dollar-sign"></i>
                <span>Smart Budget</span>
            </a>
            <a href="#memories" class="nav-item" onclick="showSection('memories')">
                <i class="fas fa-camera"></i>
                <span>Memories</span>
            </a>
            <a href="#alerts" class="nav-item" onclick="showSection('alerts')">
                <i class="fas fa-bell"></i>
                <span>Alerts</span>
            </a>
            <a href="#admin" class="nav-item admin-only" onclick="showSection('admin')" style="display: none;">
                <i class="fas fa-cog"></i>
                <span>Admin</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <header class="dashboard-header">
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            <div class="header-right">
                <!-- Theme Toggle -->
                <div class="theme-toggle-container">
                    <div class="toggle-switch toggle-with-icons" onclick="toggleTheme()">
                        <input type="checkbox" id="themeToggle">
                        <span class="toggle-slider">
                            <i class="fas fa-sun toggle-icon-left"></i>
                            <i class="fas fa-moon toggle-icon-right"></i>
                        </span>
                    </div>
                </div>
                <div class="user-info">
                    <span id="userName">Welcome back!</span>
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
            </div>
        </header>

        <!-- Dashboard Section -->
        <section id="dashboard-section" class="content-section active">
            <div class="section-header">
                <h1>Dashboard</h1>
                <p>Your travel overview</p>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalTrips">5</h3>
                        <p>Total Trips</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="countriesVisited">8</h3>
                        <p>Countries Visited</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalSpent">$2,450</h3>
                        <p>Total Spent</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-camera"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalPhotos">124</h3>
                        <p>Memories</p>
                    </div>
                </div>
            </div>

            <!-- Recent Trips -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h2>Recent Trips</h2>
                    <button class="btn-primary" onclick="showSection('plan-trip')">Plan New Trip</button>
                </div>
                <div class="trips-list" id="recentTrips">
                    <div class="trip-item">
                        <div class="trip-image">
                            <i class="fas fa-camera"></i>
                        </div>
                        <div class="trip-details">
                            <h4>Paris Adventure</h4>
                            <p>May 15-22, 2024 ‚Ä¢ 7 days</p>
                            <span class="trip-status completed">Completed</span>
                        </div>
                        <div class="trip-budget">$1,200</div>
                    </div>
                    <div class="trip-item">
                        <div class="trip-image">
                            <i class="fas fa-mountain"></i>
                        </div>
                        <div class="trip-details">
                            <h4>Tokyo Discovery</h4>
                            <p>June 10-17, 2024 ‚Ä¢ 8 days</p>
                            <span class="trip-status upcoming">Upcoming</span>
                        </div>
                        <div class="trip-budget">$1,800</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Plan Trip Section -->
        <section id="plan-trip-section" class="content-section">
            <div class="section-header">
                <h1>Plan New Trip</h1>
                <p>Create your next adventure</p>
            </div>

            <div class="trip-planner">
                <!-- Trip Type Selection -->
                <div class="planner-card">
                    <h3>Select Trip Type</h3>
                    <div class="trip-types">
                        <div class="trip-type" onclick="selectTripType('solo')">
                            <i class="fas fa-user"></i>
                            <h4>Solo</h4>
                            <p>Personal adventure</p>
                        </div>
                        <div class="trip-type" onclick="selectTripType('couple')">
                            <i class="fas fa-heart"></i>
                            <h4>Couple</h4>
                            <p>Romantic getaway</p>
                        </div>
                        <div class="trip-type" onclick="selectTripType('friends')">
                            <i class="fas fa-users"></i>
                            <h4>Friends</h4>
                            <p>Group adventure</p>
                        </div>
                    </div>
                </div>

                <!-- Destination Selection -->
                <div class="planner-card">
                    <h3>Choose Destination</h3>
                    <div class="destination-search">
                        <input type="text" id="destinationInput" placeholder="Search destinations...">
                        <button onclick="searchDestinations()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="destinations-grid" id="destinationsGrid">
                        <div class="destination-card" onclick="selectDestination('Paris')">
                            <div class="destination-image">
                                <i class="fas fa-landmark"></i>
                            </div>
                            <div class="destination-info">
                                <h4>Paris, France</h4>
                                <p>City of Light</p>
                            </div>
                        </div>
                        <div class="destination-card" onclick="selectDestination('Tokyo')">
                            <div class="destination-image">
                                <i class="fas fa-torii-gate"></i>
                            </div>
                            <div class="destination-info">
                                <h4>Tokyo, Japan</h4>
                                <p>Modern Metropolis</p>
                            </div>
                        </div>
                        <div class="destination-card" onclick="selectDestination('Bali')">
                            <div class="destination-image">
                                <i class="fas fa-umbrella-beach"></i>
                            </div>
                            <div class="destination-info">
                                <h4>Bali, Indonesia</h4>
                                <p>Tropical Paradise</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trip Details -->
                <div class="planner-card">
                    <h3>Trip Details</h3>
                    <form id="tripDetailsForm" onsubmit="createTrip(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Trip Title</label>
                                <input type="text" id="tripTitle" placeholder="My Amazing Trip">
                            </div>
                            <div class="form-group">
                                <label>Duration</label>
                                <select id="tripDuration">
                                    <option value="1-3">1-3 days</option>
                                    <option value="4-7">4-7 days</option>
                                    <option value="1-2weeks">1-2 weeks</option>
                                    <option value="2weeks+">2+ weeks</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Start Date</label>
                                <input type="date" id="startDate">
                            </div>
                            <div class="form-group">
                                <label>Budget (USD)</label>
                                <input type="number" id="tripBudget" placeholder="1000">
                            </div>
                        </div>
                        <button type="submit" class="btn-primary full-width">Create Trip</button>
                    </form>
                </div>

                <!-- Map -->
                <div class="planner-card">
                    <h3>Location Map</h3>
                    <div id="plannerMap" class="trip-map"></div>
                </div>
            </div>
        </section>

        <!-- Smart Budget Splitter Section -->
        <section id="budget-section" class="content-section">
            <div class="section-header">
                <h1>Smart Budget Splitter</h1>
                <p>AI-powered budget planning with destination insights</p>
            </div>

            <div class="smart-budget-container">
                <!-- Trip Type Selection -->
                <div class="budget-card">
                    <h3>Trip Type</h3>
                    <div class="smart-trip-types">
                        <button class="smart-trip-type-btn active" data-type="solo">
                            <i class="fas fa-user"></i>
                            <span>Solo Travel</span>
                        </button>
                        <button class="smart-trip-type-btn" data-type="couple">
                            <i class="fas fa-heart"></i>
                            <span>Couple</span>
                        </button>
                        <button class="smart-trip-type-btn" data-type="friends">
                            <i class="fas fa-users"></i>
                            <span>Friends Group</span>
                        </button>
                    </div>
                </div>

                <!-- Main Budget Tool -->
                <div class="budget-tool-grid">
                    <div class="budget-card">
                        <h3>Trip Details</h3>
                        <div class="smart-form">
                            <input type="text" id="smartTripDestination"
                                placeholder="Enter destination (e.g., Paris, Tokyo)" class="smart-input">
                            <input type="number" id="smartTripDays" placeholder="Number of days" min="1" max="30"
                                class="smart-input">
                            <input type="number" id="smartGroupSize" placeholder="Group size" value="1" min="1" max="20"
                                class="smart-input">
                            <input type="number" id="smartTotalBudget" placeholder="Total budget ($)" min="100"
                                class="smart-input">
                            <button id="calculateSmartBtn" class="btn-primary smart-calc-btn">
                                <i class="fas fa-brain"></i>
                                Calculate Smart Budget
                            </button>
                        </div>
                    </div>

                    <div class="budget-card">
                        <h3>Smart Budget Breakdown</h3>
                        <div class="budget-breakdown">
                            <div class="breakdown-item">
                                <div class="breakdown-icon">üè®</div>
                                <span class="breakdown-label">Accommodation:</span>
                                <span id="smartAccommodation" class="breakdown-amount">$0</span>
                            </div>
                            <div class="breakdown-item">
                                <div class="breakdown-icon">üçΩ</div>
                                <span class="breakdown-label">Food & Drinks:</span>
                                <span id="smartFood" class="breakdown-amount">$0</span>
                            </div>
                            <div class="breakdown-item">
                                <div class="breakdown-icon">üöó</div>
                                <span class="breakdown-label">Transportation:</span>
                                <span id="smartTransport" class="breakdown-amount">$0</span>
                            </div>
                            <div class="breakdown-item">
                                <div class="breakdown-icon">üéØ</div>
                                <span class="breakdown-label">Activities:</span>
                                <span id="smartActivities" class="breakdown-amount">$0</span>
                            </div>
                            <div class="breakdown-item">
                                <div class="breakdown-icon">üí∞</div>
                                <span class="breakdown-label">Emergency Fund:</span>
                                <span id="smartEmergency" class="breakdown-amount">$0</span>
                            </div>
                        </div>
                    </div>

                    <div class="budget-card">
                        <h3>Smart Trip Advice</h3>
                        <div id="smartTripAdvice" class="trip-advice">
                            <div class="advice-item">
                                <span class="advice-icon">üí°</span>
                                <span>Enter your trip details to get personalized advice!</span>
                            </div>
                        </div>

                        <div class="budget-summary">
                            <h4>Budget Summary</h4>
                            <div class="summary-item">
                                <span>Total Budget:</span>
                                <span id="smartTotalDisplay" class="summary-amount">$0</span>
                            </div>
                            <div class="summary-item highlight">
                                <span>Per Person:</span>
                                <span id="smartPerPerson" class="summary-amount">$0</span>
                            </div>
                            <div class="summary-item">
                                <span>Per Day:</span>
                                <span id="smartPerDay" class="summary-amount">$0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map and Attractions -->
                <div class="budget-card">
                    <h3>
                        <i class="fas fa-map-marker-alt"></i>
                        Destination Map & Attractions
                    </h3>
                    <div id="smartBudgetMap" class="smart-map"></div>
                    <div id="smartAttractionsGrid" class="attractions-grid">
                        <!-- Attractions will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Enhanced Memories Section -->
        <section id="memories-section" class="content-section">
            <div class="section-header">
                <h1>Memory Gallery</h1>
                <p>Your travel moments captured forever</p>
            </div>

            <div class="memories-container">
                <!-- Enhanced Upload Card -->
                <div class="upload-card">
                    <div class="upload-area" onclick="document.getElementById('photoUpload').click()">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <h3>Upload Travel Photos</h3>
                        <p>Drag and drop or click to select multiple images</p>
                        <span class="upload-hint">Supports JPG, PNG, WebP up to 10MB each</span>
                        <input type="file" id="photoUpload" multiple accept="image/*" style="display: none;">
                    </div>
                    <div class="upload-progress" id="uploadProgress" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <span class="progress-text" id="progressText">Uploading... 0%</span>
                    </div>
                </div>

                <!-- Gallery Filters -->
                <div class="gallery-filters">
                    <button class="filter-btn active" data-filter="all" onclick="filterMemories('all')">
                        <i class="fas fa-images"></i>
                        <span>All</span>
                        <span class="filter-count" id="allCount">0</span>
                    </button>
                    <button class="filter-btn" data-filter="recent" onclick="filterMemories('recent')">
                        <i class="fas fa-clock"></i>
                        <span>Recent</span>
                        <span class="filter-count" id="recentCount">0</span>
                    </button>
                    <button class="filter-btn" data-filter="favorites" onclick="filterMemories('favorites')">
                        <i class="fas fa-heart"></i>
                        <span>Favorites</span>
                        <span class="filter-count" id="favoritesCount">0</span>
                    </button>
                </div>

                <!-- Memories Gallery -->
                <div class="memories-gallery" id="memoriesGallery">
                    <!-- Memory cards will be dynamically populated here -->
                </div>

                <!-- Empty State -->
                <div class="empty-state" id="emptyState" style="display: none;">
                    <i class="fas fa-camera-retro"></i>
                    <h3>No memories yet</h3>
                    <p>Upload your first travel photo to get started!</p>
                </div>
            </div>
        </section>

        <!-- Alerts Section -->
        <section id="alerts-section" class="content-section">
            <div class="section-header">
                <h1>Trip Alerts</h1>
                <p>Stay updated on your travels</p>
            </div>

            <div class="alerts-container">
                <div class="alerts-settings">
                    <h3>Notification Settings</h3>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="weatherAlerts" checked>
                            <span>Weather Updates</span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="flightAlerts" checked>
                            <span>Flight Changes</span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="budgetAlerts">
                            <span>Budget Warnings</span>
                        </label>
                    </div>
                </div>

                <div class="alerts-list">
                    <h3>Recent Alerts</h3>
                    <div id="alertsList">
                        <div class="alert-item">
                            <div class="alert-icon weather">
                                <i class="fas fa-cloud-rain"></i>
                            </div>
                            <div class="alert-content">
                                <h4>Weather Update</h4>
                                <p>Rain expected in Tokyo tomorrow</p>
                                <span class="alert-time">2 hours ago</span>
                            </div>
                        </div>
                        <div class="alert-item">
                            <div class="alert-icon flight">
                                <i class="fas fa-plane"></i>
                            </div>
                            <div class="alert-content">
                                <h4>Flight Reminder</h4>
                                <p>Check-in opens in 24 hours</p>
                                <span class="alert-time">1 day ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Section -->
        <section id="admin-section" class="content-section">
            <div class="section-header">
                <h1>Admin Panel</h1>
                <p>System management</p>
            </div>

            <div class="admin-container">
                <div class="admin-stats">
                    <div class="admin-card">
                        <h3>User Analytics</h3>
                        <div class="metric">
                            <span>Total Users:</span>
                            <span>1,234</span>
                        </div>
                        <div class="metric">
                            <span>Active Users:</span>
                            <span>856</span>
                        </div>
                        <div class="metric">
                            <span>New This Month:</span>
                            <span>127</span>
                        </div>
                    </div>

                    <div class="admin-card">
                        <h3>Trip Statistics</h3>
                        <div class="metric">
                            <span>Total Trips:</span>
                            <span>2,567</span>
                        </div>
                        <div class="metric">
                            <span>Completed:</span>
                            <span>2,234</span>
                        </div>
                        <div class="metric">
                            <span>Upcoming:</span>
                            <span>333</span>
                        </div>
                    </div>
                </div>

                <div class="admin-actions">
                    <div class="admin-card">
                        <h3>Content Management</h3>
                        <button class="admin-btn">Manage Destinations</button>
                        <button class="admin-btn">Review Photos</button>
                        <button class="admin-btn">User Reports</button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Share Modal -->
    <div class="modal-overlay" id="shareModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Share Memory</h3>
                <button class="modal-close" onclick="closeShareModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="share-preview" id="sharePreview">
                    <!-- Preview will be populated -->
                </div>
                <div class="share-options">
                    <button class="share-btn whatsapp" onclick="shareToWhatsApp()">
                        <i class="fab fa-whatsapp"></i>
                        <span>WhatsApp</span>
                    </button>
                    <button class="share-btn telegram" onclick="shareToTelegram()">
                        <i class="fab fa-telegram"></i>
                        <span>Telegram</span>
                    </button>
                    <button class="share-btn instagram" onclick="shareToInstagram()">
                        <i class="fab fa-instagram"></i>
                        <span>Instagram</span>
                    </button>
                    <button class="share-btn facebook" onclick="shareToFacebook()">
                        <i class="fab fa-facebook"></i>
                        <span>Facebook</span>
                    </button>
                    <button class="share-btn twitter" onclick="shareToTwitter()">
                        <i class="fab fa-twitter"></i>
                        <span>Twitter</span>
                    </button>
                    <button class="share-btn copy" onclick="copyImageLink()">
                        <i class="fas fa-copy"></i>
                        <span>Copy Link</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-plane loading-icon"></i>
            <p>Processing your memories...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/animejs@3.2.1/lib/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <!-- Appwrite SDK -->
    <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.1"></script>
    
    <!-- Dashboard JavaScript -->
    <script src="dashboard1.js"></script>

    <!-- üëá Appwrite Username Display Script -->
    <script type="module">
        import { Client, Account } from "https://cdn.jsdelivr.net/npm/appwrite@13.0.1/+esm";

        const client = new Client();
        const account = new Account(client);

        client
            .setEndpoint("https://fra.cloud.appwrite.io/v1") // ‚úÖ Your endpoint
            .setProject("68860401002a4d8a099f");             // ‚úÖ Your project ID

        account.get()
            .then(user => {
                const nameSpan = document.getElementById("userName");
                if (nameSpan) {
                    nameSpan.textContent = `Welcome back, ${user.name || user.email.split('@')[0]}!`;
                }
            })
            .catch(error => {
                console.error("Error fetching Appwrite user:", error);
            });
    </script>
</body>
</html>
